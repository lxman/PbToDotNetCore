#COMPILE EXE
#DIM ALL

FUNCTION WorkerThread(BYVAL param AS DWORD) AS LONG
    LOCAL i AS LONG
    FOR i = 1 TO 5
        SLEEP 500
    NEXT i
    FUNCTION = 0
END FUNCTION

FUNCTION PBMAIN() AS LONG
    LOCAL hThread AS DWORD

    THREAD CREATE WorkerThread(0) TO hThread
    MSGBOX "Thread started"
    THREAD WAIT hThread
    MSGBOX "Thread completed"
    THREAD CLOSE hThread
END FUNCTION
